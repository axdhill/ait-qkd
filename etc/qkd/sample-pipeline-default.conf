# ------------------------------------------------------------
# This is a pipeline config file
#
# Author: Oliver Maurhart, <oliver.maurhart@ait.ac.at>
# 
# Copyright (C) 2015, AIT Austrian Institute of Technology
# AIT Austrian Institute of Technology GmbH
# Donau-City-Strasse 1 | 1220 Vienna | Austria
# http://www.ait.ac.at
#
# Any line starting with '#' is ignored
# ------------------------------------------------------------

# ------------------------------------------------------------
# This file configures QKD modules.
#
# Each module picks its own configuration values
# depending on the module's own name. So a module
# 'cascade' will pick all cascade.* values.
#
# More technically, each key here is of the form:
#
#   MODULE[.ROLE].NAME
#
# MODULE is a name which is to be understood by
# module implementation.
#
# ROLE is either "alice" or "bob". If ROLE is
# omitted than the value should be applied regardless
# of the concrete role.
#
#     MODULE.alice.url_peer         ... remote (bob) address
#     MODULE.alice.url_pipe_in      ... keystream input point (alice)
#     MODULE.alice.url_pipe_out     ... keystream output point (alice)
#     MODULE.bob.url_listen         ... local listen address (bob)
#     MODULE.bob.url_pipe_in        ... keystream input point (bob)
#     MODULE.bob.url_pipe_out       ... keystream output point (bob)
#     MODULE.pipeline               ... name of pipeline
#     MODULE.random_url             ... URL of random number source
#     MODULE.synchronize_keys       ... true|false for key synchronization
#     MODULE.synchronize_ttl        ... time to live for out-of-sync keys
#     MODULE.terminate_after        ... terminates module after a number of keys have been 
#                                       successfully processed. 0 --> no terminate
#     MODULE.timeout_network        ... network timeout in millisec (to remote peer module)
#     MODULE.timeout_pipe           ... keystream timeout in millisec (when pulling
#                                       keys from previous module)
#
# Default values:
#
#   Every module starts with some default values.
#   These are:
#   
#       MODULE.alice.url_pipe_in = stdin://
#       MODULE.alice.url_pipe_out = stdout://
#       MODULE.bob.url_pipe_in = stdin://
#       MODULE.bob.url_pipe_out = stdout://
#       MODULE.pipeline = default
#       MODULE.synchronize_keys = true
#       MODULE.synchronize_ttl = 10
#
#
#       --- I M P O R T A N T ---
#
# The one and only method to connect modules is via url_pipe_in and url_pipe_out.
# The address of the key stream generated by one module is defined by url_pipe_out. 
# This has to match the address of the next module's pipe_in.
#
#       previous_module.url_pipe_out == next_module.url_pipe_in
#
# Example: connect bb84 and cascade on alice side:
#
#       bb84.alice.url_pipe_out = ipc:///tmp/qkd/cascade.alice.in
#       ...
#       cascade.alice.url_pipe_in = ipc:///tmp/qkd/cascade.alice.in
#       ...
# 
# However, when you start the pipeline via the qkd-pipeline tool, then 
# setting the 'autostart="true"' attribute of the pipeline XML entity will
# interconnect the modules for you.
# 
# Some modules do need more configuration. These are additional keys,
# e.g. 
#           cascade.passes = 14     ... number of passes for cascade module
#
# Such keys have to be studied in the context of the module itself.

# ------------------------------------------------------------
#
# this sample pipeline config file starts this pipeline
# on the localhost(!)
#
#       qkd_bb84 --> 
#       qkd_cascade --> 
#       qkd_confirmation --> 
#       qkd_resize --> 
#       qkd_privacy_amplification --> STDOUT
#
# ------------------------------------------------------------

[module]

# bb84
bb84.alice.url_peer = tcp://127.0.0.1:7120
bb84.alice.url_pipe_in = ipc:///tmp/qkd/bb84.alice.in
bb84.alice.url_pipe_out = ipc:///tmp/qkd/cascade.alice.in
bb84.bob.url_listen = tcp://127.0.0.1:7120
bb84.bob.url_pipe_in = ipc:///tmp/qkd/bb84.bob.in
bb84.bob.url_pipe_out = ipc:///tmp/qkd/cascade.bob.in
bb84.key_id_pattern = 0/0
bb84.rawkey_length = 2048
bb84.pipeline = default
bb84.synchronize_keys = false

# cascade
cascade.alice.url_peer = tcp://127.0.0.1:7130
cascade.alice.url_pipe_in = ipc:///tmp/qkd/cascade.alice.in
cascade.alice.url_pipe_out = ipc:///tmp/qkd/confirmation.alice.in
cascade.bob.url_listen = tcp://127.0.0.1:7130
cascade.bob.url_pipe_in = ipc:///tmp/qkd/cascade.bob.in
cascade.bob.url_pipe_out = ipc:///tmp/qkd/confirmation.bob.in
cascade.passes = 14
cascade.pipeline = default
cascade.synchronize_keys = false

# confirmation
confirmation.alice.url_peer = tcp://127.0.0.1:7160
confirmation.alice.url_pipe_in = ipc:///tmp/qkd/confirmation.alice.in
confirmation.alice.url_pipe_out = ipc:///tmp/qkd/resize.alice.in
confirmation.bob.url_listen = tcp://127.0.0.1:7160
confirmation.bob.url_pipe_in = ipc:///tmp/qkd/confirmation.bob.in
confirmation.bob.url_pipe_out = ipc:///tmp/qkd/resize.bob.in
confirmation.rounds = 10
confirmation.pipeline = default
confirmation.synchronize_keys = false

# resize
resize.alice.url_peer = tcp://127.0.0.1:7170
resize.alice.url_pipe_in = ipc:///tmp/qkd/resize.alice.in
resize.alice.url_pipe_out = ipc:///tmp/qkd/privacy-amplification.alice.in
resize.bob.url_listen = tcp://127.0.0.1:7170
resize.bob.url_pipe_in = ipc:///tmp/qkd/resize.bob.in
resize.bob.url_pipe_out = ipc:///tmp/qkd/privacy-amplification.bob.in
resize.min_key_size = 10000
resize.pipeline = default
resize.synchronize_keys = true
resize.synchronize_ttl = 20

# privacy-amplification
privacy-amplification.alice.url_peer = tcp://127.0.0.1:7180
privacy-amplification.alice.url_pipe_in = ipc:///tmp/qkd/privacy-amplification.alice.in
privacy-amplification.alice.url_pipe_out = ipc:///tmp/qkd/tee.alice.in
privacy-amplification.bob.url_listen = tcp://127.0.0.1:7180
privacy-amplification.bob.url_pipe_in = ipc:///tmp/qkd/privacy-amplification.bob.in
privacy-amplification.bob.url_pipe_out = ipc:///tmp/qkd/tee.bob.in
#privacy-amplification.reduction_rate = 0.9
privacy-amplification.security_bits = 100
privacy-amplification.pipeline = default
privacy-amplification.synchronize_keys = false

# tee
tee.alice.url_pipe_in = ipc:///tmp/qkd/tee.alice.in
tee.alice.url_pipe_out =
tee.bob.url_pipe_in = ipc:///tmp/qkd/tee.bob.in
tee.bob.url_pipe_out =
tee.pipeline = default
tee.synchronize_keys = false

